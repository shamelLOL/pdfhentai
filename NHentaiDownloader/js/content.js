(()=>{let e=[];chrome.storage.local.get({allIds:[],lastUrl:""},(function(e){e.lastUrl!=location.href&&chrome.storage.local.set({allIds:[],lastUrl:location.href})})),chrome.storage.sync.get({displayCheckbox:!0},(function(l){chrome.storage.local.get({allIds:[]},(function(t){if(l.displayCheckbox){let l=/\/g\/([0-9]+)\//g,o=document.getElementsByClassName("caption"),n=0;do{let c=l.exec(document.documentElement.innerHTML);e.push(c[1]),o[n].innerHTML+='<br/><br/><input id="'+c[1]+'" type="checkbox" '+(t.allIds.includes(c[1])?"checked":"")+"> NHentai Downloader:<br/>Add to downloads<br/>&nbsp;",n++}while(n<o.length);for(let l=0;l<e.length;l++){let t=e[l];document.getElementById(t).addEventListener("change",(function(){chrome.storage.local.get({allIds:[]},(function(e){let l=e.allIds;if(document.getElementById(t).checked)l.push(t);else{let e=l.indexOf(t);-1!==e&&l.splice(e,1)}chrome.storage.local.set({allIds:l})}))}))}}}))}))})();